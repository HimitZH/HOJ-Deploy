(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f3e982a2"],{"038f":function(t,e,a){},"701d":function(t,e,a){"use strict";a("038f")},"9a3b":function(t,e,a){"use strict";var s=a("fb6a"),n=a("5530"),o=a("3228"),i=(s=a("5880"),a("9a36"));e.a={methods:{getContestRankData:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,a=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.showChart&&!a&&this.$refs.chart.showLoading({maskColor:"rgba(250, 250, 250, 0.8)"});var s={currentPage:e,limit:this.limit,cid:this.$route.params.contestID,forceRefresh:!!this.forceUpdate};o.a.getContestRank(s).then((function(s){t.showChart&&!a&&t.$refs.chart.hideLoading(),t.total=s.data.data.total,1===e&&t.applyToChart(s.data.data.records.slice(0,10)),t.applyToTable(s.data.data.records)}))},handleAutoRefresh:function(t){var e=this;1==t?this.refreshFunc=setInterval((function(){e.page=1,e.getContestRankData(1,!0)}),1e4):clearInterval(this.refreshFunc)}},computed:Object(n.a)(Object(n.a)(Object(n.a)({},Object(s.mapGetters)(["isContestAdmin"])),Object(s.mapState)({contest:function(t){return t.contest.contest},contestProblems:function(t){return t.contest.contestProblems}})),{},{showChart:{get:function(){return this.$store.state.contest.itemVisible.chart},set:function(t){this.$store.commit("changeContestItemVisible",{chart:t})}},showTable:{get:function(){return this.$store.state.contest.itemVisible.table},set:function(t){this.$store.commit("changeContestItemVisible",{table:t})}},forceUpdate:{get:function(){return this.$store.state.contest.forceUpdate},set:function(t){this.$store.commit("changeRankForceUpdate",{value:t})}},refreshDisabled:function(){return this.contest.status===i.a.ENDED}}),beforeDestroy:function(){clearInterval(this.refreshFunc)}}},"9d33":function(t,e,a){"use strict";a.r(e),a("99af"),a("4160"),a("b64b"),a("d3b7"),a("159b");var s=a("5530"),n=a("4a89"),o=a.n(n),i=a("5880"),r=(n=a("9a3b"),a("90b9"));s={name:"OIContestRank",components:{Pagination:function(){return Promise.resolve().then(a.bind(null,"5072"))},Avatar:o.a},mixins:[n.a],data:function(){return{total:0,page:1,limit:30,contestID:"",dataRank:[],autoRefresh:!1,options:{title:{text:this.$i18n.t("m.Top_10_Teams"),left:"center"},tooltip:{trigger:"axis"},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0},magicType:{show:!0,type:["line","bar"]},saveAsImage:{show:!0,title:this.$i18n.t("m.save_as_image")}},right:"10%",top:"5%"},calculable:!0,xAxis:[{type:"category",data:["root"],boundaryGap:!0,axisLabel:{interval:0,showMinLabel:!0,showMaxLabel:!0,align:"center",formatter:function(t,e){return r.a.breakLongWords(t,14)}},axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value"}],grid:{left:"11%"},series:[{name:this.$i18n.t("m.Score"),type:"bar",barMaxWidth:"80",data:[0],markPoint:{data:[{type:"max",name:"max"}]}}]}}},mounted:function(){this.contestID=this.$route.params.contestID,this.getContestRankData(1)},computed:{contest:function(){return this.$store.state.contest.contest},isMobileView:function(){return window.screen.width<768}},methods:Object(s.a)(Object(s.a)({},Object(i.mapActions)(["getContestProblems"])),{},{cellClassName:function(t){var e=t.row,a=(t.rowIndex,t.column);t=t.columnIndex;return"username"===a.property&&e.userCellClassName?e.userCellClassName:"id"!==a.property&&"totalScore"!==a.property&&"username"!==a.property&&"realname"!==a.property?this.isContestAdmin?e.cellClassName[[this.contestProblems[t-4].displayId]]:e.cellClassName[[this.contestProblems[t-3].displayId]]:void 0},getUserTotalSubmit:function(t){this.$router.push({name:"ContestSubmissionList",query:{username:t}})},getUserHomeByUsername:function(t,e){this.$router.push({name:"UserHome",query:{username:e,uid:t}})},getContestProblemById:function(t){this.$router.push({name:"ContestProblemDetails",params:{contestID:this.contestID,problemID:t}})},applyToChart:function(t){var e=this,a=[],s=[];t.forEach((function(t){a.push(t[e.contest.rankShowName]),s.push(t.totalScore)})),this.options.xAxis[0].data=a,this.options.series[0].data=s},applyToTable:function(t){var e=JSON.parse(JSON.stringify(t));e.forEach((function(t,a){var s=t.submissionInfo,n={};Object.keys(s).forEach((function(t){e[a][t]=s[t];var o=s[t];0==o?n[t]="oi-0":0<o&&o<100?n[t]="oi-between":100==o&&(n[t]="oi-100")})),e[a].cellClassName=n,"female"==e[a].gender&&(e[a].userCellClassName="bg-female")})),this.dataRank=e},downloadRankCSV:function(){r.a.downloadFile("/api/file/download-contest-rank?cid=".concat(this.$route.params.contestID,"&forceRefresh=").concat(!!this.forceUpdate))}})},a("701d"),i=a("2877"),s=Object(i.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{attrs:{shadow:""}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"panel-title"},[t._v(t._s(t.$t("m.Contest_Rank")))]),a("span",{staticStyle:{float:"right","font-size":"20px"}},[a("el-popover",{attrs:{trigger:"hover",placement:"left-start"}},[a("i",{staticClass:"el-icon-s-tools",attrs:{slot:"reference"},slot:"reference"}),a("div",{attrs:{id:"switches"}},[a("p",[a("span",[t._v(t._s(t.$t("m.Chart")))]),a("el-switch",{model:{value:t.showChart,callback:function(e){t.showChart=e},expression:"showChart"}})],1),a("p",[a("span",[t._v(t._s(t.$t("m.Table")))]),a("el-switch",{model:{value:t.showTable,callback:function(e){t.showTable=e},expression:"showTable"}})],1),a("p",[a("span",[t._v(t._s(t.$t("m.Auto_Refresh"))+"(10s)")]),a("el-switch",{attrs:{disabled:t.refreshDisabled},on:{change:t.handleAutoRefresh},model:{value:t.autoRefresh,callback:function(e){t.autoRefresh=e},expression:"autoRefresh"}})],1),t.isContestAdmin?[a("p",[a("span",[t._v(t._s(t.$t("m.Force_Update")))]),a("el-switch",{attrs:{disabled:t.refreshDisabled},model:{value:t.forceUpdate,callback:function(e){t.forceUpdate=e},expression:"forceUpdate"}})],1)]:t._e(),[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.downloadRankCSV}},[t._v(t._s(t.$t("m.Download_as_CSV")))])]],2)])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showChart,expression:"showChart"}],staticClass:"echarts"},[a("ECharts",{ref:"chart",attrs:{options:t.options,autoresize:!0}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showTable,expression:"showTable"}]},[a("vxe-table",{ref:"OIContestRank",attrs:{round:"",border:"","auto-resize":"",size:"medium",align:"center",data:t.dataRank,"cell-class-name":t.cellClassName,"seq-config":{startIndex:(this.page-1)*this.limit}}},[a("vxe-table-column",{attrs:{field:"id",type:"seq","min-width":"50",fixed:"left"}}),t.isMobileView?a("vxe-table-column",{attrs:{field:"username","min-width":"300",title:t.$t("m.User"),"header-align":"center",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("avatar",{attrs:{username:s[t.contest.rankShowName],inline:!0,size:37,color:"#FFF",src:s.avatar,title:s[t.contest.rankShowName]}}),a("span",{staticStyle:{float:"right","text-align":"right"}},[a("a",{on:{click:function(e){return t.getUserHomeByUsername(s.uid,s.username)}}},[a("span",{staticClass:"contest-username"},["female"==s.gender?a("span",{staticClass:"female-flag"},[t._v("Girl")]):t._e(),t._v(t._s(s[t.contest.rankShowName]))]),s.school?a("span",{staticClass:"contest-school"},[t._v(t._s(s.school))]):t._e()])])]}}])}):a("vxe-table-column",{attrs:{field:"username",fixed:"left","min-width":"300",title:t.$t("m.User"),"header-align":"center",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("avatar",{attrs:{username:s[t.contest.rankShowName],inline:!0,size:37,color:"#FFF",src:s.avatar,title:s[t.contest.rankShowName]}}),a("span",{staticStyle:{float:"right","text-align":"right"}},[a("a",{on:{click:function(e){return t.getUserHomeByUsername(s.uid,s.username)}}},[a("span",{staticClass:"contest-username"},["female"==s.gender?a("span",{staticClass:"female-flag"},[t._v("Girl")]):t._e(),t._v(t._s(s[t.contest.rankShowName]))]),s.school?a("span",{staticClass:"contest-school"},[t._v(t._s(s.school))]):t._e()])])]}}],null,!1,3985709549)}),t.isContestAdmin?a("vxe-table-column",{attrs:{field:"realname","min-width":"96",title:t.$t("m.RealName")}}):t._e(),a("vxe-table-column",{attrs:{field:"totalScore",title:t.$t("m.Total_Score"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("span",[a("a",{staticStyle:{color:"rgb(87, 163, 243)"},on:{click:function(e){return t.getUserTotalSubmit(s.username)}}},[t._v(t._s(s.totalScore))]),a("br"),a("span",{staticClass:"problem-time"},[t._v("("+t._s(s.totalTime)+"ms)")])])]}}])}),t._l(t.contestProblems,(function(e){return a("vxe-table-column",{key:e.displayId,attrs:{"min-width":"120"},scopedSlots:t._u([{key:"header",fn:function(){return[e.color?a("span",{staticStyle:{"vertical-align":"top"}},[a("svg",{staticClass:"icon",attrs:{t:"1633685184463",viewBox:"0 0 1088 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5840",width:"25",height:"25"}},[a("path",{attrs:{d:"M575.872 849.408c-104.576 0-117.632-26.56-119.232-31.808-6.528-22.528 32.896-70.592 63.744-96.768l-1.728-2.624c137.6-42.688 243.648-290.112 243.648-433.472A284.544 284.544 0 0 0 478.016 0a284.544 284.544 0 0 0-284.288 284.736c0 150.4 116.352 415.104 263.744 438.336-25.152 29.568-50.368 70.784-39.104 108.928 12.608 43.136 62.72 63.232 157.632 63.232 7.872 0 11.52 9.408 4.352 19.52-21.248 29.248-77.888 63.424-167.68 63.424V1024c138.944 0 215.936-74.816 215.936-126.528a46.72 46.72 0 0 0-16.32-36.608 56.32 56.32 0 0 0-36.416-11.456zM297.152 297.472c0 44.032-38.144 25.344-38.144-38.656 0-108.032 85.248-195.712 190.592-195.712 62.592 0 81.216 39.232 38.08 39.232-105.152 0.064-190.528 87.04-190.528 195.136z",fill:e.color,"p-id":"5841"}})])]):t._e(),a("span",[a("a",{staticClass:"emphasis",on:{click:function(a){return t.getContestProblemById(e.displayId)}}},[t._v(t._s(e.displayId))])])]},proxy:!0},{key:"default",fn:function(s){return s=s.row,[s.submissionInfo[e.displayId]?a("div",[a("span",[t._v(t._s(s.submissionInfo[e.displayId]))]),a("br"),s.timeInfo&&s.timeInfo[e.displayId]?a("span",{staticStyle:{"font-size":"12px"}},[t._v("("+t._s(s.timeInfo[e.displayId])+"ms)")]):t._e()]):t._e()]}}],null,!0)})}))],2)],1),a("Pagination",{attrs:{total:t.total,"page-size":t.limit,current:t.page,layout:"prev, pager, next, sizes"},on:{"update:pageSize":function(e){t.limit=e},"update:page-size":function(e){t.limit=e},"update:current":function(e){t.page=e},"on-change":t.getContestRankData,"on-page-size-change":function(e){return t.getContestRankData(1)}}})],1)}),[],!1,null,"9ac1e038",null);e.default=s.exports}}]);